# Event Analytics API

–í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∏–π —Å–µ—Ä–≤—ñ—Å –¥–ª—è –∑–±–æ—Ä—É –ø–æ–¥—ñ–π (events) —Ç–∞ –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ –Ω–∞ –±–∞–∑—ñ FastAPI –∑ PostgreSQL.

## üöÄ –û—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

- **–®–≤–∏–¥–∫–∏–π –∑–±—ñ—Ä –ø–æ–¥—ñ–π**: –í–∏—Å–æ–∫–æ–ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–∞ –æ–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ–π –∑ –º–∞—Å–æ–≤–∏–º–∏ –æ–ø–µ—Ä–∞—Ü—ñ—è–º–∏
- **–ê–Ω–∞–ª—ñ—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º—É —á–∞—Å—ñ**: –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∞–Ω–∞–ª—ñ—Ç–∏–∫–∏ –∑ –≤–∞—à–∏—Ö –¥–∞–Ω–∏—Ö
- **–í–∞–ª—ñ–¥–∞—Ü—ñ—è –¥–∞–Ω–∏—Ö**: –ö–æ–º–ø–ª–µ–∫—Å–Ω–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—è –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º Pydantic
- **–ß–∏—Å—Ç–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞**: –ë–∞–≥–∞—Ç–æ—Ä—ñ–≤–Ω–µ–≤–∞ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –∑ —Ä–æ–∑–¥—ñ–ª–µ–Ω–Ω—è–º –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ
- **–ê–≤—Ç–æ–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ API –¥–æ–∫—É–º–µ–Ω—Ç–∏ –∑ Swagger UI
- **Docker –≥–æ—Ç–æ–≤–∏–π**: –ü–æ–≤–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü—ñ—è –∑ Docker Compose
- **–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥**: –°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω–µ –ª–æ–≥—É–≤–∞–Ω–Ω—è —Ç–∞ health checks

## üèóÔ∏è –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

```
app/
‚îú‚îÄ‚îÄ api/v1/            # API –µ–Ω–¥–ø–æ—ñ–Ω—Ç–∏
‚îú‚îÄ‚îÄ core/              # –û—Å–Ω–æ–≤–Ω—ñ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
‚îú‚îÄ‚îÄ models/            # –ú–æ–¥–µ–ª—ñ –¥–∞–Ω–∏—Ö —Ç–∞ –ë–î
‚îú‚îÄ‚îÄ services/          # –ë—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∞
‚îî‚îÄ‚îÄ tests/             # –¢–µ—Å—Ç–∏
```

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

### Docker (–†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ)

```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Å–µ—Ä–≤—ñ—Å–∏
docker compose up -d

# 2. API –¥–æ—Å—Ç—É–ø–Ω–µ –∑–∞ –∞–¥—Ä–µ—Å–æ—é:
# - API: http://localhost:8000
# - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è: http://localhost:8000/docs
# - PostgreSQL: localhost:5433
# - Redis: localhost:6379
```

### –õ–æ–∫–∞–ª—å–Ω–∞ —Ä–æ–∑—Ä–æ–±–∫–∞

```bash
# 1. –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ
pip install -r requirements.txt

# 2. –ù–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –∑–º—ñ–Ω–Ω—ñ –æ—Ç–æ—á–µ–Ω–Ω—è
cp .env.example .env

# 3. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó
alembic upgrade head

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ —Å–µ—Ä–≤–µ—Ä
uvicorn app.main:app --reload
```

## üìñ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è API

### –î–æ–¥–∞–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π

```bash
curl -X POST "http://localhost:8000/api/v1/events" 
  -H "Content-Type: application/json" 
  -d '{
    "events": [
      {
        "event_id": "550e8400-e29b-41d4-a716-446655440000",
        "user_id": 123,
        "event_type": "user_login",
        "occurred_at": "2025-01-13T10:30:00",
        "properties": {
          "browser": "Chrome",
          "ip": "192.168.1.1"
        }
      }
    ]
  }'
```

### –û—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ–¥—ñ–π

```bash
# –í—Å—ñ –ø–æ–¥—ñ—ó
curl "http://localhost:8000/api/v1/events"

# –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É
curl "http://localhost:8000/api/v1/events?user_id=123"

# –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Ç–∏–ø—É –ø–æ–¥—ñ—ó
curl "http://localhost:8000/api/v1/events?event_type=user_login"

# –ü–∞–≥—ñ–Ω–∞—Ü—ñ—è
curl "http://localhost:8000/api/v1/events?limit=10&offset=20"
```

## üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –≤—Å—ñ —Ç–µ—Å—Ç–∏
pytest

# –ó –ø–æ–∫—Ä–∏—Ç—Ç—è–º –∫–æ–¥—É
pytest --cov=app tests/

# –ö–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ç–µ—Å—Ç–æ–≤–∏–π —Ñ–∞–π–ª
pytest tests/test_events.py -v
```

## üîß –†–æ–∑—Ä–æ–±–∫–∞

### –ú—ñ–≥—Ä–∞—Ü—ñ—ó –ë–î

```bash
# –°—Ç–≤–æ—Ä–∏—Ç–∏ –Ω–æ–≤—É –º—ñ–≥—Ä–∞—Ü—ñ—é
alembic revision --autogenerate -m "Description"

# –ó–∞—Å—Ç–æ—Å—É–≤–∞—Ç–∏ –º—ñ–≥—Ä–∞—Ü—ñ—ó
alembic upgrade head
```

### –Ø–∫—ñ—Å—Ç—å –∫–æ–¥—É

```bash
# –õ—ñ–Ω—Ç–∏–Ω–≥
flake8 app/

# –§–æ—Ä–º–∞—Ç—É–≤–∞–Ω–Ω—è
black app/
```

##  –ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥

- **Health Check**: `GET /health`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è**: `/docs` —Ç–∞ `/redoc`
- **–°—Ç—Ä—É–∫—Ç—É—Ä–æ–≤–∞–Ω—ñ –ª–æ–≥–∏**: JSON —Ñ–æ—Ä–º–∞—Ç
